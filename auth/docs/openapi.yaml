openapi: 3.0.3
info:
  title: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞.
  description: |-
    üå≤üå≤üçÑüå≤üçÑüçÑüå≤üçÑüå≤üçÑüå≤üå≤üçÑüå≤üçÑüå≤üçÑüçÑüçÑüå≤üçÑüçÑüå≤üçÑüå≤üå≤
  termsOfService: http://swagger.io/terms/
  contact:
    email: example@gmail.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.11
security:
  - BasicAuth: []
  - BearerAuth: []
servers:
  - url: http://localhost:8000/api/v1
    description: Dev server


paths:
  
#  -------------- AUTH -------------------- AUTH --------------

  /register:
    post:
      summary: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      tags:
        - Auth
      security:
        - BasicAuth: []
      requestBody:
        required: true
        description: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Credentials"
      responses:
        "201":
          description: –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDataResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /login:
    post:
      summary: –ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ä—É —Ç–æ–∫–µ–Ω–æ–≤.
      tags:
        - Auth
      security:
        - BasicAuth: []
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å access –∏ refresh —Ç–æ–∫–µ–Ω–∞–º–∏.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenPair"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"


  /logout:
    post:
      summary: –û—Ç–æ–∑–≤–∞—Ç—å refresh —Ç–æ–∫–µ–Ω.
      tags:
        - Auth
      security:
        - BearerAuth: []
      requestBody:
        required: true
        description: –†–µ—Ñ—Ä–µ—à —Ç–æ–∫–µ–Ω.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshToken"
      responses:
        "204":
          description: No Content
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: –£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
  /logout_all:
    post:
      summary: –û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ refresh —Ç–æ–∫–µ–Ω—ã.
      tags:
        - Auth
      security:
        - BearerAuth: []
      requestBody:
        required: true
        description: –†–µ—Ñ—Ä–µ—à —Ç–æ–∫–µ–Ω.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshToken"
      responses:
        "204":
          description: No Content
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: –£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
  /refresh:
    post:
      summary: –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä—É —Ç–æ–∫–µ–Ω–æ–≤.
      tags:
        - Auth
      operationId: jwt-refresh
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshToken"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenPair"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


#  -------------- USERS -------------------- USERS --------------


  /users/me:
    get:
      summary: –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - BearerAuth: []
      tags:
        - Users
      operationId: user-profile
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDataResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
    patch:
      summary: –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      tags:
        - Users
      operationId: user-update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserData"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDataResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /users/me/history:
    get:
      summary: –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ –≤ –∞–∫–∫–∞—É–Ω—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - BearerAuth: []
      tags:
        - Users
      operationId: user-history
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –∏—Å—Ç–æ—Ä–∏–µ–π –≤—Ö–æ–¥–æ–≤ –≤ –∞–∫–∫–∞—É–Ω—Ç.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AccessEvent"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"


  /users/me/allowed_devices:
    get:
      summary: –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ –≤ –∞–∫–∫–∞—É–Ω—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - BearerAuth: []
      tags:
        - Users
      operationId: get_allowed_devices
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –∏—Å—Ç–æ—Ä–∏–µ–π –≤—Ö–æ–¥–æ–≤ –≤ –∞–∫–∫–∞—É–Ω—Ç.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AllowedDevice"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"


  /users/me/change_password:
    post:
      summary: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      tags:
        - Users
      operationId: user-password-change
      requestBody:
        required: true
        description: –°—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PasswordChange"
      responses:
        "200":
          $ref: "#/components/responses/200Ok"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
  /users/me/change_email:
    post:
      summary: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –µ–º–µ–π–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      tags:
        - Users
      operationId: user-email-change
      requestBody:
        required: true
        description: –ù–æ–≤—ã–π –µ–º–µ–π–ª.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmailChange"
      responses:
        "200":
          $ref: "#/components/responses/200Ok"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /users/{user_id}:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - ServiceBearerAuth: []
      tags:
        - Users
      operationId: list-roles
      parameters:
        - $ref: "#/components/parameters/UserId"
      responses:
        "200":
          description: –£—Å–ø–µ—Ö.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CredentialsFullResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "500":
          $ref: "#/components/responses/500InternalError"
  
    patch:
      summary: –ù–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - ServiceBearerAuth: []
      tags:
        - Users
      operationId: update-user
      parameters:
        - $ref: "#/components/parameters/UserId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CredentialsFull"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CredentialsFullResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
    delete:
      summary: –ù–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      security:
        - ServiceBearerAuth: []
      tags:
        - Users
      operationId: delete-user
      parameters:
        - $ref: "#/components/parameters/UserId"
      responses:
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /users/{user_id}/set_roles:
    post:
      summary: –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
      security:
        - ServiceBearerAuth: []
      tags:
        - Users
      operationId: set_roles
      parameters:
        - $ref: "#/components/parameters/UserId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RolesIdList"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDataResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"

  
  /users/{user_id}/revoke_roles:
    post:
      summary: –û—Ç–æ–∑–≤–∞—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–æ–ª–∏.
      security:
        - ServiceBearerAuth: []
      tags:
        - Users
      operationId: revoke_roles
      parameters:
        - $ref: "#/components/parameters/UserId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RolesIdList"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserDataResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


#  -------------- ROLES -------------------- ROLES --------------


  /roles:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: get_role_list
      responses:
        "200":
          description: –£—Å–ø–µ—Ö.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RolesListResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"
  
    post:
      summary: –°–æ–∑–¥–∞—Ç—å —Ä–æ–ª—å.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: create-role
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Role"
      responses:
        "201":
          description: –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–∏.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /roles/{role_id}:
    patch:
      summary: –ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: update-role
      parameters:
        - $ref: "#/components/parameters/RoleId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Role"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
    delete:
      summary: –£–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: delete-role
      parameters:
        - $ref: "#/components/parameters/RoleId"
      responses:
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
  /roles/{role_id}/set_permissions:
    post:
      summary: –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Ä–æ–ª–∏.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: set_permissions
      parameters:
        - $ref: "#/components/parameters/RoleId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/permissionIdList"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
  
  /roles/{role_id}/revoke_permissions:
    post:
      summary: –û—Ç–æ–∑–≤–∞—Ç—å —É —Ä–æ–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.
      security:
        - ServiceBearerAuth: []
      tags:
        - Roles
      operationId: revoke_permissions
      parameters:
        - $ref: "#/components/parameters/RoleId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/permissionIdList"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RoleResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


#  ------------ PERMISSIONS ------------------ PERMISSIONS ------------


  /permissions:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.
      security:
        - ServiceBearerAuth: []
      tags:
        - Permissions
      operationId: get_permission_list
      responses:
        "200":
          description: –£—Å–ø–µ—Ö.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/permissionListResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "500":
          $ref: "#/components/responses/500InternalError"
    post:
      summary: –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ.
      security:
        - BearerAuth: []
      tags:
        - Permissions
      operationId: create-permission
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/permission"
      responses:
        "201":
          description: –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/permissionResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"

  /permissions/update:
    post:
      summary: –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (—Å–ø–∏—Å–∫–æ–º).
      security:
        - ServiceBearerAuth: []
      tags:
        - Permissions
      operationId: update-permission
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/permissionList"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/permissionListResponse"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"


  /permissions/{permission_id}:
    patch:
      summary: –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ.
      security:
        - ServiceBearerAuth: []
      tags:
        - Permissions
      operationId: update-permission
      parameters:
        - $ref: "#/components/parameters/permissionId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/permission"
      responses:
        "200":
          description: –£—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/permission"
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "422":
          $ref: "#/components/responses/422UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500InternalError"
  
    delete:
      summary: –£–¥–∞–ª–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ.
      security:
        - ServiceBearerAuth: []
      tags:
        - Permissions
      operationId: delete-permission
      parameters:
        - $ref: "#/components/parameters/permissionId"
      responses:
        "400":
          $ref: "#/components/responses/400BadRequest"
        "401":
          $ref: "#/components/responses/401Unauthorized"
        "404":
          $ref: "#/components/responses/404NotFound"
        "500":
          $ref: "#/components/responses/500InternalError"



# --------------                            -----------------
# --------------         COMPONENTS         -----------------
# --------------                           -----------------


components:
  securitySchemes: #  ------ RESPONSES --------------------- RESPONSES
    BasicAuth:
      type: http
      scheme: basic
      description: HTTP Basic authentication with username and password.
    BearerAuth:
      type: http
      scheme: bearer
      description: JWT authentication.
      bearerFormat: JWT
    ServiceBearerAuth:
      type: http
      scheme: bearer
      description: JWT authentication (must be a service or manager).
      bearerFormat: JWT

  parameters: #  ------ PARAMETERS --------------------- PARAMETERS
    UserAgent:
      in: header
      name: User-Agent
      description: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω."
      schema:
        type: string
        example: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36"
      required: true
    IPAddress:
      in: header
      name: X-Forwarded-For
      description: "–ú–∞—Ä—à—Ä—É—Ç –∏ IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω."
      schema:
        type: string
        example: "103.0.113.165, 60.91.3.17, 120.192.338.678"
      required: true
    UserId:
      in: path
      name: user_id
      required: true
      description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      schema:
        type: string
      example:  e1d7fcec-e8d9-4967-8150-ae0996e44713
    RoleId:
      in: path
      name: role_id
      required: true
      description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–ª–∏
      schema:
        type: string
      example:  e1d7fcec-e8d9-4967-8150-ae0996e44713
    permissionId:
      in: path
      name: permission_id
      required: true
      description: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
      schema:
        type: string
      example:  e1d7fcec-e8d9-4967-8150-ae0996e44713
  
  responses: #  ------RESPONSES--------------------- RESPONSES
    InternalError:
      description: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: –û—à–∏–±–∫–∞
                example: Something went wrong.
    200Ok:
      description: –£—Å–ø–µ—à–Ω–æ.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: OK
    400BadRequest:
      description: –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: Bad request.
    401Unauthorized:
      description: –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: Unauthorized or wrong user credentials.
    404NotFound:
      description: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: Not found.
    422UnprocessableEntity:
      description: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: Unprocessable entity.
    500InternalError:
      description: –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
      content:
        application/json:
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: –°–æ–æ–±—â–µ–Ω–∏–µ.
                example: Internal Server Error.

  schemas: #  -------- SCHEMAS --------------------------- SCHEMAS
    Credentials:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: user@email.com
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        password:
          type: string
          format: password
          example: SD_g151@1af
  
    CredentialsFull:
      type: object
      required:
        - email
        - password
        - is_active
        - is_superuser
      properties:
        email:
          type: string
          format: email
          example: user@email.com
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        password:
          type: string
          format: password
          example: SD_g151@1af
        is_active:
          type: boolean
          example: True
        is_superuser:
          type: boolean
          example: True
  
    CredentialsFullResponse:
      type: object
      required:
        - id
        - email
        - is_active
        - is_superuser
        - roles
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
        email:
          type: string
          format: email
          example: user@email.com
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        is_active:
          type: boolean
          example: True
        is_superuser:
          type: boolean
          example: True
        roles:
          type: array
          example: []
          description: –†–æ–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
          items:
              type: string
  
    UserData:
      type: object
      required:
        - email
      properties:
        somefield:
          type: string
          example: somefield
  
    UserDataResponse:
      type: object
      required:
        - id
        - email
        - roles
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
        email:
          type: string
          format: email
          example: user@email.com
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        roles:
          type: array
          example: []
          description: –†–æ–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
          items:
              type: string
  
    EmailChange:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          example: user@email.com
          pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
  
    PasswordChange:
      type: object
      required:
        - old_password
        - new_password
        - new_password_re
      properties:
        password:
          type: string
          example: SD_g151@1af
        new_password:
          type: string
          example: New@Password123
        new_password_re:
          type: string
          example: New@Password123
  
    Token:
      type: string
      maxLength: 0
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
  
    TokenPair:
      type: object
      description: –ü–∞—Ä–∞ JWT-—Ç–æ–∫–µ–Ω–æ–≤ (access/refersh)
      properties:
        access:
          $ref: "#/components/schemas/Token"
        refresh:
          $ref: "#/components/schemas/Token"
  
    RefreshToken:
      type: object
      description: –†–µ—Ñ—Ä–µ—à —Ç–æ–∫–µ–Ω
      properties:
        refresh:
          $ref: "#/components/schemas/Token"
  
    AccessEvent:
      type: object
      required:
        - id
        - user_agent
        - ip_address
        - datetime
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
        user_agent:
          type: string
          example: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36"
        ip_address:
          type: string
          example: "103.0.113.165, 60.91.3.17, 120.192.338.678"
        datetime:
          type: string
          format: date-time
          example: 2017-07-21T17:32:28Z
  
    AllowedDevice:
      type: object
      required:
        - id
        - user_agent
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
        user_agent:
          type: string
          example: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36"
  
    Role:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä"
        description:
          type: string
          example: "–°–ª–µ–¥–∏—Ç –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª —Ä–µ—Å—É—Ä—Å–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–º–∞—Ö –∏–ª–∏ —Ä–∞–∑–¥–µ–ª–∞—Ö —Å–µ—Ç–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞"
  
    RoleId:
      type: object
      required:
        - id
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
  
    RolesIdList:
      type: array
      items:
        $ref: "#/components/schemas/RoleId"
      example:
        - {"id": "e1d7fcec-e8d9-4967-8150-ae0996e44713"}
        - {"id": "e1d7fcec-e8d9-4967-8150-ae0996e44713"}
  
    RoleResponse:
      type: object
      required:
        - id
        - name
        - permissions
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
        name:
          type: string
          example: "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä"
        description:
          type: string
          example: "–°–ª–µ–¥–∏—Ç –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª —Ä–µ—Å—É—Ä—Å–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–º–∞—Ö –∏–ª–∏ —Ä–∞–∑–¥–µ–ª–∞—Ö —Å–µ—Ç–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞"
        permissions:
          type: array
          example: []
          description: –†–∞–∑—Ä–µ—à–µ–Ω–∏—è, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –¥–ª—è —Ä–æ–ª–∏
          items:
              type: string
        

    RolesListResponse:
      type: array
      items:
        $ref: "#/components/schemas/RoleResponse"

    permission:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "show_18+_films"
        description:
          type: string
          example: "–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ñ–∏–ª—å–º—ã 18+"
  
    permissionList:
      type: array
      items:
        $ref: "#/components/schemas/permission"
  
    permissionResponse:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "show_18+_films"
        description:
          type: string
          example: "–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ñ–∏–ª—å–º—ã 18+"
  
    permissionListResponse:
      type: array
      items:
        $ref: "#/components/schemas/permissionResponse"
  
    permissionId:
      type: object
      required:
        - id
      properties:
        id:
          type: string
          example: 6931c67c-d85f-11ed-afa1-0242ac120002
  
    permissionIdList:
      type: array
      items:
        $ref: "#/components/schemas/permissionId"
      example:
        - {"id": "e1d7fcec-e8d9-4967-8150-ae0996e44713"}
        - {"id": "e1d7fcec-e8d9-4967-8150-ae0996e44713"}
  